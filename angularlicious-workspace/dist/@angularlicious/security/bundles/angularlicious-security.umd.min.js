!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angularlicious/foundation"),require("rxjs/add/observable/throw"),require("@angularlicious/rules-engine"),require("@angularlicious/logging"),require("@angular/core"),require("@angular/common/http"),require("rxjs/add/operator/map"),require("rxjs/add/operator/catch"),require("rxjs/add/operator/observeOn"),require("rxjs/add/operator/toPromise"),require("@angular/router"),require("@angular/forms"),require("@angular/common"),require("@angularlicious/core")):"function"==typeof define&&define.amd?define("@angularlicious/security",["exports","@angularlicious/foundation","rxjs/add/observable/throw","@angularlicious/rules-engine","@angularlicious/logging","@angular/core","@angular/common/http","rxjs/add/operator/map","rxjs/add/operator/catch","rxjs/add/operator/observeOn","rxjs/add/operator/toPromise","@angular/router","@angular/forms","@angular/common","@angularlicious/core"],r):r((e.angularlicious=e.angularlicious||{},e.angularlicious.security={}),e.angularliciousFoundation,e.rxjs["add/observable/throw"],e.angularliciousRulesEngine,e.angularliciousLogging,e.ng.core,e.ng.common.http,e.rxjs["add/operator/map"],e.rxjs["add/operator/catch"],e.rxjs["add/operator/observeOn"],e.rxjs["add/operator/toPromise"],e.ng.router,e.ng.forms,e.ng.common,e.angularliciousCore)}(this,function(e,n,r,t,s,u,i,o,a,c,l,g,p,d,b){"use strict";var m=function(e,r){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])})(e,r)};function h(e,r){function i(){this.constructor=e}m(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}var v=function(i){function e(e){var r=i.call(this)||this;return r.subscriber=e,r.actionName="RegisterSubscriberAction",r}return h(e,i),e.prototype.preValidateAction=function(){console.log("Running the [preValidateAction] for the "+this.actionName+" action."),this.validationContext.withSource(this.actionName).addRule(new t.StringIsNotNullEmptyRange("NameIsValid","The name value is not valid. Must be between 1-40 characters.",this.subscriber.Name,2,40,!0)).addRule(new t.StringIsNotNullEmptyRange("EmailIsValid","The email address value is not valid. Must be between 5-60 characters.",this.subscriber.EmailAddress,5,60,!0))},e.prototype.performAction=function(){this.loggingService.log(this.actionName,s.Severity.Information,"Running the [performAction] for the "+this.actionName+"."),this.response=this.businessProvider.securityApiService.registerSubscriber(this.subscriber)},e}(function(e){function r(){return e.call(this)||this}return h(r,e),r.prototype.Do=function(e){this.businessProvider=e,this.serviceContext=e.serviceContext,this.loggingService=e.loggingService,this.execute()},r}(n.ActionBase)),f=function(o){function e(e,r,i){var t=o.call(this,e,i)||this;return t.httpService=r,t}return h(e,o),e.prototype.registerSubscriber=function(e){var r="api/subscriber/register",i=this.serviceName+" preparing to call: "+r;this.loggingService.log(this.serviceName,s.Severity.Information,i);var t=JSON.stringify(e),o=this.httpService.createRequestOptions(n.HttpRequestMethod.POST,this.httpService.createHeader(!1),r,t);return this.httpService.get(o)},e.decorators=[{type:u.Injectable}],e.ctorParameters=function(){return[{type:i.HttpClient},{type:n.HttpBaseService},{type:s.AngularliciousLoggingService}]},e}(n.HttpBaseService),S=function(t){function e(e,r){var i=t.call(this,e)||this;return i.securityApiService=r,i}return h(e,t),e.prototype.registerSubscriber=function(e){var r=new v(e);return r.Do(this),r.response},e.decorators=[{type:u.Injectable}],e.ctorParameters=function(){return[{type:s.AngularliciousLoggingService},{type:f}]},e}(n.ServiceBase),y=function(e,r){this.SubscriptionStart=new Date,this.Name=e,this.EmailAddress=r},x=function(t){function e(e,r){var i=t.call(this,e)||this;return i.businessProvider=r,i.serviceName="AngularliciousSecurityService",i.businessProvider.serviceContext=i.serviceContext,i.businessProvider.loggingService=i.loggingService,i}return h(e,t),e.prototype.registerSubscriber=function(e){var r="Preparing to register subscriber: "+JSON.stringify(e);return this.loggingService.log(this.serviceName,s.Severity.Information,r),this.businessProvider.registerSubscriber(e)},e.prototype.verifyService=function(){if(this.loggingService&&this.businessProvider&&this.businessProvider.securityApiService)return!0},e.decorators=[{type:u.Injectable}],e.ctorParameters=function(){return[{type:s.AngularliciousLoggingService},{type:S}]},e}(n.ServiceBase),N=function(n){function e(e,r,i,t){var o=n.call(this,"RegisterSubscriberComponent",r,t)||this;return o.securityService=e,o.formBuilder=i,o.subscribe=new u.EventEmitter,o}return h(e,n),e.prototype.ngOnInit=function(){this.buildForm()},e.prototype.buildForm=function(){this._form=this.formBuilder.group({subscriberName:["",p.Validators.required],emailAddress:["",p.Validators.required]})},e.prototype.submitForm=function(){this.securityService.resetServiceContext(),this.subscriber=new y(this._form.value.subscriberName,this._form.value.emailAddress),this.subscribeUser(this.subscriber)},e.prototype.subscribeUser=function(e){var r=this;this.securityService.registerSubscriber(e).subscribe(function(e){return r.handleSubscribeUser(e)},function(e){return r.handleServiceErrors(e,r.securityService.serviceContext)},function(){return r.finishRequest(r.componentName)})},e.prototype.handleSubscribeUser=function(e){var r="[handleSubscribeUser]: Preparing to handle the response from the [SecurityService] in the "+this.componentName+".";if(this.loggingService.log(this.componentName,s.Severity.Information,r),e)if(e.IsSuccess){this.loggingService.log(this.componentName,s.Severity.Information,"Successfully processed request to create subscriber. Prepare to download..."),this.subscribe.emit(e)}else this.handleServiceErrors(null,this.securityService.serviceContext)},e.decorators=[{type:u.Component,args:[{selector:"bm-register-subscriber",template:'<angularlicious-alert [alertNotification]="alertNotification" [hasMessage]="alertNotification.showAlert"></angularlicious-alert>\n\x3c!-- SUBSCRIBE SIGN-UP FORM --\x3e\n<form [formGroup]="_form" (ngSubmit)="submitForm()">\n  \x3c!-- SUBSCRIBER NAME --\x3e\n  <div class="input-group form-group-no-border">\n    <span class="input-group-addon">\n      <i class="now-ui-icons users_circle-08"></i>\n    </span>\n    <input type="text" formControlName="subscriberName" class="form-control" placeholder="Name...">\n  </div>\n  \x3c!-- SUBSCRIBER EMAIL --\x3e\n  <div class="input-group form-group-no-border">\n    <span class="input-group-addon">\n      <i class="now-ui-icons ui-1_email-85"></i>\n    </span>\n    <input type="text" formControlName="emailAddress" class="form-control" placeholder="Email...">\n  </div>\n  \x3c!-- SUBSCRIBE BUTTON --\x3e\n  <button class="btn btn-neutral btn-round btn-lg">Subscribe\n    <i class="fa fa-check ml-1"></i>\n  </button>\n</form>\n\x3c!-- SUBSCRIBE SIGN-UP FORM --\x3e',styles:[""]}]}],e.ctorParameters=function(){return[{type:x},{type:s.AngularliciousLoggingService},{type:p.FormBuilder},{type:g.Router}]},e.propDecorators={subscribe:[{type:u.Output}]},e}(n.ComponentBase),A=function(){function e(){}return e.decorators=[{type:u.NgModule,args:[{imports:[s.AngularliciousLoggingModule,n.AngularliciousFoundationModule,b.AngularliciousCoreModule,d.CommonModule,p.FormsModule,p.ReactiveFormsModule,i.HttpClientModule],declarations:[N],exports:[N],providers:[s.AngularliciousLoggingService,f,S]}]}],e}();e.AngularliciousSecurityModule=A,e.AngularliciousSecurityService=x,e.RegisterSubscriberComponent=N,e.Subscriber=y,e.ɵb=f,e.ɵa=S,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angularlicious-security.umd.min.js.map